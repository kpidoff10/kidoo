; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html
;
; Board: ESP32-S3-DevKitC-1 (AYWHP / ESP-1-N16R8)
;   - 16MB Flash QD / 8MB PSRAM OPI
;   - 2x USB-C: USB-OTG (UART) + USB-JTAG (debug)
;   - LED RGB intégrée sur GPIO 48

[platformio]
default_envs = basic

; Configuration commune ESP32-S3-DevKitC-1
[env]
platform = espressif32 
board = esp32-s3-devkitc-1
framework = arduino
board_build.partitions = default_16MB.csv
board_build.flash_mode = qio
board_upload.flash_size = 16MB
; PSRAM OPI 8MB - Configuration mémoire pour N16R8
board_build.arduino.memory_type = qio_opi

; USB CDC pour Serial Monitor (port USB-OTG)
build_flags = 
	-DARDUINO_USB_MODE=1
	-DARDUINO_USB_CDC_ON_BOOT=1
	-DCORE_DEBUG_LEVEL=0
	-Os
	-ffunction-sections
	-fdata-sections
	-Wl,--gc-sections
	; LED RGB intégrée DevKitC-1
	-DBUILTIN_RGB_LED_PIN=48
	; PSRAM 8MB OPI
	-DBOARD_HAS_PSRAM

; Dépendances communes
lib_deps = 
	fastled/FastLED@^3.6.0
	bblanchon/ArduinoJson@^7.0.0
	adafruit/Adafruit PN532@^1.3.4
	https://github.com/schreibfaul1/ESP32-audioI2S.git

monitor_speed = 115200
; Pas de DTR/RTS pour USB CDC natif
monitor_dtr = 0
monitor_rts = 0
; Upload via USB-OTG
upload_speed = 921600

[env:basic]
build_flags = 
	${env.build_flags}
	-DKIDOO_MODEL_BASIC

[env:mini]
build_flags = 
	${env.build_flags}
	-DKIDOO_MODEL_MINI
lib_deps = 
	${env.lib_deps}
	msteltman/ESP32Sampler@^1.1.0
